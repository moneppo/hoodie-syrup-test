$(function () {

    var getConfig = _.partial(couchr.get, '/_api/plugins/plugin%2Fhoodie-plugin-template/');
    var setConfig = _.partial(couchr.put, '/_api/plugins/plugin%2Fhoodie-plugin-template/');

    function updateConfig(obj, callback) {
        getConfig(function (err, doc) {
            if (err) {
                return callback(err);
            }
            doc.config = _.extend(doc.config, obj);
            setConfig(doc, callback);
        });
    }

    getConfig(function (err, doc) {
        if (err) {
            return alert(err);
        }
        var code = doc.config.manifest.replace(/\n/g, '<br/>');
        $('[name=manifest]').html('<code>' + code + '</code>');
    });
});
